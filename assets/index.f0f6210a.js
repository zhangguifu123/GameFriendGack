var z=Object.defineProperty,F=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var g=(e,t,s)=>t in e?z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,h=(e,t)=>{for(var s in t||(t={}))j.call(t,s)&&g(e,s,t[s]);if(_)for(var s of _(t))G.call(t,s)&&g(e,s,t[s]);return e},f=(e,t)=>F(e,U(t));import{i as M,g as O}from"./gameManage.04a1778e.js";import{h as p,s as b}from"./user.7a03029a.js";import{_ as P,r as v,o as C,p as R,K as a,V as l,M as c,J as T,G as E,Y as J,q as x,L as o}from"./index.19c7010c.js";const K=e=>p.request("post","banner/upload",{data:e}),Y=e=>p.request("get",`banner/list/${e}`),Z=e=>p.request("delete",`banner/${e}`);const A={data(){return{headerStyle:{"background-color":"rgba(0,0,0,0.05)"},data:[],page:1,total:0,limit:10,pictureIndex:0,pictureShow:!1,addData:{image:"",name:"",manager_name:"",game_id:"",manager_id:""},rules:{image:{required:!0,message:"\u8BF7\u4E0A\u4F20\u6D77\u62A5"},name:{required:!0,message:"\u8BF7\u9009\u62E9\u6BD4\u8D5B"}},dialogVisible:!1,options:[]}},mounted(){this.getData()},computed:{fileList(){return this.addData.image?[{url:this.addData.image}]:[]},pictureList(){return this.data.map(e=>e.image)}},methods:{del(e){Z(e).then(()=>{b("\u5220\u9664\u6210\u529F\uFF01"),this.getData()})},getData(){Y(this.page).then(({data:e})=>{this.data=e.bannerList,this.total=e.total,this.limit=e.limit})},httpRequest(e){M(e.file).then(({data:t})=>{this.addData.image=t})},timeFormat(e){return e.replace(/T/g," ").replace(/\.[\d]{6}Z/g,"")},pictureShowF(e){this.pictureIndex=e,this.pictureShow=!0},change(e){this.addData.name=e[0].name,this.addData.game_id=e[0].game_id.toString()},dialogShow(){this.dialogVisible=!0,O("1",{uid:"n",level:0,subject:0}).then(({data:e})=>{this.options=e.gameList.map(t=>({label:t.name,value:{name:t.name,game_id:t.id}}))})},addBanner(){this.$refs.ref.validate(e=>{if(e){const t=f(h({},this.addData),{manager_id:v.getItem("info").id.toString(),manager_name:v.getItem("info").username});K(t).then(()=>{b("\u4E0A\u4F20\u6210\u529F\uFF01"),this.getData(),this.dialogVisible=!1})}})}}},H={class:"bg-fff p-10"},Q=c("\u70B9\u51FB\u4E0A\u4F20"),W=c(" \u5220\u9664 "),X={class:"mt-10 flex",style:{"justify-content":"right"}},$={class:"upload-icon mr-10"},ee=c("\u63D0\u4EA4"),te=c("\u53D6\u6D88");function ae(e,t,s,ne,n,r){const m=o("el-button"),d=o("el-table-column"),w=o("el-image"),y=o("el-popconfirm"),k=o("el-table"),D=o("el-image-viewer"),S=o("el-pagination"),q=o("iconifyIconOnline"),V=o("el-upload"),u=o("el-form-item"),B=o("el-cascader"),I=o("el-form"),L=o("el-dialog");return C(),R("div",H,[a(m,{type:"primary",onClick:r.dialogShow,class:"m-10"},{default:l(()=>[Q]),_:1},8,["onClick"]),a(k,{data:n.data,border:"","header-cell-style":n.headerStyle},{default:l(()=>[a(d,{prop:"id",label:"\u7F16\u53F7",width:"80"}),a(d,{label:"\u6BD4\u8D5B\u540D\u79F0",prop:"name","min-width":"120"}),a(d,{label:"\u6D77\u62A5",width:"100"},{default:l(i=>[a(w,{style:{width:"50px",height:"30px"},src:i.row.image,fit:"cover",onClick:N=>r.pictureShowF(i.$index)},null,8,["src","onClick"])]),_:1}),a(d,{prop:"manager_name",label:"\u53D1\u5E03\u7BA1\u7406\u5458",width:"100"}),a(d,{label:"\u53D1\u5E03\u65F6\u95F4","min-width":"160"},{default:l(i=>[c(T(r.timeFormat(i.row.created_at)),1)]),_:1}),a(d,{label:"\u64CD\u4F5C",width:"120"},{default:l(i=>[a(y,{title:"\u786E\u8BA4\u5220\u9664?","confirm-button-text":"\u786E\u8BA4","cancel-button-text":"\u53D6\u6D88",onConfirm:N=>r.del(i.row.id)},{reference:l(()=>[a(m,{type:"danger",size:"mini"},{default:l(()=>[W]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data","header-cell-style"]),n.pictureShow?(C(),E(D,{key:0,teleported:"","initial-index":n.pictureIndex,"hide-on-click-modal":"","url-list":r.pictureList,onClose:t[0]||(t[0]=i=>n.pictureShow=!1)},null,8,["initial-index","url-list"])):J("",!0),x("div",X,[a(S,{background:"",layout:"total,prev, pager, next","page-size":n.limit,"onUpdate:page-size":t[1]||(t[1]=i=>n.limit=i),"current-page":n.page,"onUpdate:current-page":t[2]||(t[2]=i=>n.page=i),onCurrentChange:r.getData,onPrevClick:r.getData,onNextClick:r.getData,total:n.total},null,8,["page-size","current-page","onCurrentChange","onPrevClick","onNextClick","total"])]),a(L,{"model-value":n.dialogVisible,title:"\u6DFB\u52A0banner","close-on-click-modal":!1,onClose:t[4]||(t[4]=i=>n.dialogVisible=!1)},{default:l(()=>[a(I,{ref:"ref",model:n.addData,"label-width":"auto",rules:n.rules},{default:l(()=>[a(u,{label:"\u6D77\u62A5",required:"",prop:"image"},{default:l(()=>[a(V,{class:"upload-demo flex",limit:1,action:"","http-request":r.httpRequest,"file-list":r.fileList,"list-type":"picture"},{default:l(()=>[x("div",$,[a(q,{icon:"plus"})])]),_:1},8,["http-request","file-list"])]),_:1}),a(u,{prop:"name",label:"\u8D5B\u4E8B\u540D\u79F0",required:""},{default:l(()=>[a(B,{onChange:r.change,options:n.options,placeholder:"\u8BF7\u9009\u62E9\u6BD4\u8D5B"},null,8,["onChange","options"])]),_:1}),a(u,null,{default:l(()=>[a(m,{type:"primary",onClick:r.addBanner},{default:l(()=>[ee]),_:1},8,["onClick"]),a(m,{type:"danger",onClick:t[3]||(t[3]=i=>n.dialogVisible=!1)},{default:l(()=>[te]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value"])])}var se=P(A,[["render",ae],["__scopeId","data-v-0e4ccec8"]]);export{se as default};
