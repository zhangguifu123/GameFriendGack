import{i as G,a as k,e as q,r as w,g as j}from"./gameManage.04a1778e.js";import{s as v}from"./user.7a03029a.js";import{_ as V,L as r,o as y,p as C,K as t,V as i,q as h,ay as z,az as S,M as p,J as D}from"./index.19c7010c.js";const U={emits:["confirm"],data(){return{gameData:{data:{img:"",name:"",organizer:"",game_time:"",sign_up_time:"",subject:"",level:"",content:""},fileList:[]},level:[{label:"\u6821\u7EA7",value:"\u6821\u7EA7"},{label:"\u7701\u7EA7",value:"\u7701\u7EA7"},{label:"\u56FD\u5BB6\u7EA7",value:"\u56FD\u5BB6\u7EA7"}],subject:[{label:"\u6570\u5B66\u5EFA\u6A21\u7ADE\u8D5B",value:"\u6570\u5B66\u5EFA\u6A21\u7ADE\u8D5B"},{label:"\u7269\u7406\u7ADE\u8D5B",value:"\u7269\u7406\u7ADE\u8D5B"},{label:"\u7535\u5B50\u7ADE\u8D5B",value:"\u7535\u5B50\u7ADE\u8D5B"},{label:"\u521B\u65B0\u521B\u4E1A\u5927\u8D5B",value:"\u521B\u65B0\u521B\u4E1A\u5927\u8D5B"},{label:"\u5E02\u573A\u8C03\u7814\u5927\u8D5B",value:"\u5E02\u573A\u8C03\u7814\u5927\u8D5B"},{label:"\u7A0B\u5E8F\u8BBE\u8BA1\u5927\u8D5B",value:"\u7A0B\u5E8F\u8BBE\u8BA1\u5927\u8D5B"},{label:"\u6CD5\u5EAD\u6A21\u62DF\u5927\u8D5B",value:"\u6CD5\u5EAD\u6A21\u62DF\u5927\u8D5B"}],rules:{content:{required:!0,message:"\u8BF7\u586B\u5199\u8D5B\u4E8B\u8BE6\u60C5",trigger:"change"},img:{required:!0,message:"\u8BF7\u4E0A\u4F20\u6D77\u62A5",trigger:"change"},name:{required:!0,message:"\u8BF7\u8F93\u5165\u8D5B\u4E8B\u540D\u79F0",trigger:"change"},organizer:{required:!0,message:"\u8BF7\u8F93\u5165\u4E3B\u529E\u65B9",trigger:"change"},sign_up_time:{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u540D\u65F6\u95F4",trigger:"change"},game_time:{required:!0,message:"\u8BF7\u9009\u62E9\u6BD4\u8D5B\u65F6\u95F4",trigger:"change"},subject:{required:!0,message:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u79D1\u76EE",trigger:"change"},level:{required:!0,message:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u7EA7\u522B",trigger:"change"}},operation:"add"}},props:{initData:{type:Object}},watch:{initData:{handler(l){if(JSON.stringify(l)!=="{}"){for(let e in l)e=="level"||e=="subject"?this.gameData.data[e]=[l[e]]:this.gameData.data=l;this.gameData.fileList=[{url:JSON.parse(l.img)[0]}],this.operation="edit"}else this.operation="add",this.gameData.data={},this.gameData.fileList=[]},immediate:!0}},methods:{httpRequest(l){G(l.file).then(({data:e})=>{this.gameData.data.img=e})},cancel(){this.$emit("cancel",!1)},clickAddGame(){this.$refs.gameRef.validate(l=>{if(l){const e={};for(let m in this.gameData.data)m=="img"?e[m]=JSON.stringify([this.gameData.data[m]]):e[m]=this.gameData.data[m].toString();e.publisher="1",this.operation==="add"?k(e).then(m=>{m.code===0&&(this.$emit("confirm",!0),v("\u53D1\u5E03\u6210\u529F"))}):q(e,e.id).then(m=>{m.code===0&&(this.$emit("confirm",!0),v("\u4FEE\u6539\u6210\u529F"))})}})}}},L=l=>(z("data-v-eef9f7ee"),l=l(),S(),l),N={class:"upload-icon mr-10"},Y=L(()=>h("div",{style:{color:"#bbb"}},"\u5907\u6CE8:\u5728\u8D5B\u4E8B\u8BE6\u60C5\u91CC\u9762\u5199\u4E0A\u8054\u7CFB\u65B9\u5F0F\u4F1A\u66F4\u597D\u54E6\uFF01",-1)),I=p("\u63D0\u4EA4"),H=p("\u53D6\u6D88");function M(l,e,m,x,a,s){const c=r("iconifyIconOnline"),d=r("el-upload"),u=r("el-form-item"),g=r("el-input"),f=r("el-date-picker"),b=r("el-cascader"),_=r("el-button"),o=r("el-form");return y(),C("div",null,[t(o,{ref:"gameRef",model:a.gameData.data,"label-width":"auto",rules:a.rules},{default:i(()=>[t(u,{label:"\u56FE\u7247\u4E0A\u4F20",prop:"img",required:""},{default:i(()=>[t(d,{class:"upload-demo flex",limit:1,name:"image",action:"","http-request":s.httpRequest,"file-list":a.gameData.fileList,"list-type":"picture"},{default:i(()=>[h("div",N,[t(c,{icon:"plus"})])]),_:1},8,["http-request","file-list"])]),_:1}),t(u,{prop:"name",label:"\u8D5B\u4E8B\u540D\u79F0",required:""},{default:i(()=>[t(g,{modelValue:a.gameData.data.name,"onUpdate:modelValue":e[0]||(e[0]=n=>a.gameData.data.name=n)},null,8,["modelValue"])]),_:1}),t(u,{prop:"name",label:"\u4E3B\u529E\u65B9",required:""},{default:i(()=>[t(g,{modelValue:a.gameData.data.organizer,"onUpdate:modelValue":e[1]||(e[1]=n=>a.gameData.data.organizer=n)},null,8,["modelValue"])]),_:1}),t(u,{prop:"game_time",label:"\u6BD4\u8D5B\u65F6\u95F4",required:""},{default:i(()=>[t(f,{modelValue:a.gameData.data.game_time,"onUpdate:modelValue":e[2]||(e[2]=n=>a.gameData.data.game_time=n),type:"datetime",placeholder:"\u9009\u62E9\u6BD4\u8D5B\u65F6\u95F4","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),t(u,{prop:"sign_up_time",label:"\u62A5\u540D\u622A\u6B62\u65F6\u95F4",required:""},{default:i(()=>[t(f,{modelValue:a.gameData.data.sign_up_time,"onUpdate:modelValue":e[3]||(e[3]=n=>a.gameData.data.sign_up_time=n),placeholder:"\u9009\u62E9\u62A5\u540D\u622A\u6B62\u65F6\u95F4","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),t(u,{prop:"subject",label:"\u7ADE\u8D5B\u79D1\u76EE",required:""},{default:i(()=>[t(b,{modelValue:a.gameData.data.subject,"onUpdate:modelValue":e[4]||(e[4]=n=>a.gameData.data.subject=n),options:a.subject,placeholder:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u79D1\u76EE"},null,8,["modelValue","options"])]),_:1}),t(u,{prop:"level",label:"\u7ADE\u8D5B\u7EA7\u522B",required:""},{default:i(()=>[t(b,{modelValue:a.gameData.data.level,"onUpdate:modelValue":e[5]||(e[5]=n=>a.gameData.data.level=n),options:a.level,placeholder:"\u8BF7\u9009\u62E9\u7ADE\u8D5B\u7EA7\u522B"},null,8,["modelValue","options"])]),_:1}),t(u,{prop:"content",label:"\u8D5B\u4E8B\u8BE6\u60C5",required:""},{default:i(()=>[t(g,{modelValue:a.gameData.data.content,"onUpdate:modelValue":e[6]||(e[6]=n=>a.gameData.data.content=n),type:"textarea"},null,8,["modelValue"]),Y]),_:1}),t(u,null,{default:i(()=>[t(_,{type:"primary",onClick:s.clickAddGame},{default:i(()=>[I]),_:1},8,["onClick"]),t(_,{type:"danger",onClick:s.cancel},{default:i(()=>[H]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])])}var O=V(U,[["render",M],["__scopeId","data-v-eef9f7ee"]]);const R={data(){return{level:0,subject:0,initData:{dataList:[]},page:1,limit:10,total:0,dialogVisible:!1,headerStyle:{"background-color":"rgba(0,0,0,0.05)"},editGameData:{},contentDialog:!1,content:""}},components:{addGameComponent:O},mounted(){this.getGameinit()},methods:{levelFilterHandler(l,e){return l==e.level},subjectFilterHandler(l,e){return l==e.subject},clickRemoveGame(l){w(l).then(({code:e})=>{e===0&&(v("\u4E0B\u67B6\u6210\u529F"),this.getGameinit())})},editGame(l){this.editGameData=l,this.dialogVisible=!0},addGame(){this.dialogVisible=!0,this.editGameData={}},confirm(l){l&&(this.getGameinit(),this.dialogVisible=!1)},showContentDialog(l){this.content=l,this.contentDialog=!0},getGameinit(){j(this.page.toString(),{uid:"n",level:this.level,subject:this.subject}).then(({data:l})=>{this.initData.dataList=l.gameList,this.limit=l.limit,this.total=l.total})}}},B={class:"bg-fff p-10"},F=p("\u53D1\u5E03\u6BD4\u8D5B"),J=p("\u67E5\u770B"),T={class:"flex"},A=p("\u7F16\u8F91"),P={class:"mt-10 flex",style:{"justify-content":"right"}};function E(l,e,m,x,a,s){const c=r("el-button"),d=r("el-table-column"),u=r("el-popconfirm"),g=r("el-table"),f=r("el-pagination"),b=r("addGameComponent"),_=r("el-dialog");return y(),C("div",B,[t(c,{type:"primary",onClick:s.addGame,size:"large"},{default:i(()=>[F]),_:1},8,["onClick"]),t(g,{data:a.initData.dataList,class:"mt-10",border:"","header-cell-style":a.headerStyle},{default:i(()=>[t(d,{prop:"name",label:"\u6BD4\u8D5B\u540D\u79F0"}),t(d,{prop:"organizer",label:"\u4E3B\u529E\u65B9"}),t(d,{prop:"level",label:"\u8D5B\u4E8B\u7EA7\u522B",width:"110",filters:[{text:"\u6821\u7EA7",value:"\u6821\u7EA7"},{text:"\u7701\u7EA7",value:"\u7701\u7EA7"},{text:"\u56FD\u5BB6\u7EA7",value:"\u56FD\u5BB6\u7EA7"}],"filter-method":s.levelFilterHandler},null,8,["filter-method"]),t(d,{prop:"subject",label:"\u8D5B\u4E8B\u79D1\u76EE",width:"110",filters:[{text:"\u6570\u5B66\u5EFA\u6A21\u7ADE\u8D5B",value:"\u6570\u5B66\u5EFA\u6A21\u7ADE\u8D5B"},{text:"\u7269\u7406\u7ADE\u8D5B",value:"\u7269\u7406\u7ADE\u8D5B"},{text:"\u7535\u5B50\u7ADE\u8D5B",value:"\u7535\u5B50\u7ADE\u8D5B"},{text:"\u521B\u65B0\u521B\u4E1A\u5927\u8D5B",value:"\u521B\u65B0\u521B\u4E1A\u5927\u8D5B"},{text:"\u5E02\u573A\u8C03\u7814\u5927\u8D5B",value:"\u5E02\u573A\u8C03\u7814\u5927\u8D5B"},{text:"\u7A0B\u5E8F\u8BBE\u8BA1\u5927\u8D5B",value:"\u7A0B\u5E8F\u8BBE\u8BA1\u5927\u8D5B"},{text:"\u6CD5\u5EAD\u6A21\u62DF\u5927\u8D5B",value:"\u6CD5\u5EAD\u6A21\u62DF\u5927\u8D5B"}],"filter-method":s.subjectFilterHandler},null,8,["filter-method"]),t(d,{prop:"game_time",label:"\u6BD4\u8D5B\u65F6\u95F4",width:"160"}),t(d,{prop:"sign_up_time",label:"\u62A5\u540D\u622A\u6B62\u65F6\u95F4",width:"120"}),t(d,{prop:"collections",label:"\u6536\u85CF\u4EBA\u6570",width:"90"}),t(d,{label:"\u8BE6\u60C5",width:"90"},{default:i(o=>[t(c,{type:"primary",size:"small",onClick:n=>s.showContentDialog(o.row.content)},{default:i(()=>[J]),_:2},1032,["onClick"])]),_:1}),t(d,{label:"\u64CD\u4F5C",width:"180"},{default:i(o=>[h("div",T,[t(c,{type:"primary",size:"small",onClick:n=>s.editGame(o.row)},{default:i(()=>[A]),_:2},1032,["onClick"]),t(u,{title:"\u786E\u8BA4\u4E0B\u67B6\u8BE5\u6BD4\u8D5B?",confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",onConfirm:n=>s.clickRemoveGame(o.row.id)},{reference:i(()=>[t(c,{type:"danger",size:"small",disabled:o.row.status==0},{default:i(()=>[p(D(o.row.status==1?"\u4E0B\u67B6":"\u5DF2\u4E0B\u67B6"),1)]),_:2},1032,["disabled"])]),_:2},1032,["onConfirm"])])]),_:1})]),_:1},8,["data","header-cell-style"]),h("div",P,[t(f,{background:"",layout:"total,prev, pager, next","page-size":a.limit,"onUpdate:page-size":e[0]||(e[0]=o=>a.limit=o),"current-page":a.page,"onUpdate:current-page":e[1]||(e[1]=o=>a.page=o),onCurrentChange:s.getGameinit,onPrevClick:s.getGameinit,onNextClick:s.getGameinit,total:a.total},null,8,["page-size","current-page","onCurrentChange","onPrevClick","onNextClick","total"])]),t(_,{"model-value":a.dialogVisible,title:"\u53D1\u5E03\u6BD4\u8D5B","close-on-click-modal":!1,onClose:e[3]||(e[3]=o=>a.dialogVisible=!1)},{default:i(()=>[t(b,{initData:a.editGameData,onConfirm:s.confirm,onCancel:e[2]||(e[2]=o=>a.dialogVisible=!1)},null,8,["initData","onConfirm"])]),_:1},8,["model-value"]),t(_,{title:"\u8D5B\u4E8B\u8BE6\u60C5","append-to-body":"",modelValue:a.contentDialog,"onUpdate:modelValue":e[4]||(e[4]=o=>a.contentDialog=o)},{default:i(()=>[p(D(a.content),1)]),_:1},8,["modelValue"])])}var X=V(R,[["render",E],["__scopeId","data-v-40ffd177"]]);export{X as default};
